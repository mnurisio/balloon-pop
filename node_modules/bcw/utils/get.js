const https = require('https');

function get(url) {
  return new Promise((resolve, reject) => {
    https.get(url, {
      headers: {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0",
        "Cache-Control": "no-cache",
      }
    }, (res) => handleResponse(res, resolve, reject));
  });
}
function handleResponse(res, resolve, reject) {
  if (res.statusCode != 200) {
    return reject(res.statusCode);
  }

  let rawData = '';
  res.on('data', (chunk) => {
    rawData += chunk;
  });

  res.on('end', () => {
    try {
      const parsedData = JSON.parse(rawData.toString());
      resolve(parsedData);
    } catch (error) {
      reject(error);
    }
  });
}

exports.get = get;